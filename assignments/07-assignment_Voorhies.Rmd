---
title: "07-assignment_Voorhies"
author: "Patrick Voorhies"
date: "10/14/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question 1: Load the packages and the data

```{r}

#Load the packages
rm(list = ls())
library(tidyverse)
library(stats)
library(flexclust)
library(ggplot2)
library(LICORS)
library(knitr)
library(modelr)
library(readxl)

#Load the dataset


ec <- read_xlsx("turkiyestudentevaluationgeneric.xlsx")
ec

```


## Question 2: Select 10 related variables for analysis

```{r}
#Questions 13-28 have to do with the instructor, so I will load these.

ec1 <- ec %>% 
       select("Q13","Q14","Q15","Q16","Q17","Q18","Q19","Q20","Q21","Q22","Q23","Q24","Q25","Q26","Q27", "Q28")
```

## Question 3: Run the clustering algorithm to identify 3 clusters

```{r}
#Cluster the data into 3 clusters
eccluster<-kmeanspp(ec, k = 3, start = "random", iter.max = 1000, nstart = 5)

#Make a table from the clusters
table(eccluster$cluster)
```
### Of the 3 clusters, there are 2359, 2227, and 1234 records per respective group

## Question 4: Summarize the clusters
```{r}
# Add predictions
ec1$cluster <- eccluster$cluster

# Examine relationship of cluster assignment to chars.
mycols <- c("Group 1", "Group 2", "Group 3")

#Proportion of a variable across all three clusters 
pt <- prop.table(table(ec1$cluster, eccluster$cluster), margin = 1)

# Sorts into proportionate clusters by questions  (had to rely on some team help on this one!)
pt <- pt * 100
pt <- round(pt, 1)
pt

pt <- prop.table(table(ec1$cluster, eccluster$cluster), margin = 1)

rownames(pt) <- mycols
pt <- pt * 100
pt <- round(pt, 1)
pt

prop.table(table(ec1$cluster, ec1$Q13), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q14), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q15), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q16), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q17), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q18), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q19), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q20), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q21), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q22), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q23), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q24), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q25), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q26), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q27), margin = 1) %>% kable()
prop.table(table(ec1$cluster, ec1$Q28), margin = 1) %>% kable()

var.means <- colMeans(ec1)
var.means <- var.means[-(length(var.means))]

# Generate a summary by cluster
sum1 <- ec1 %>% group_by(cluster) %>% summarize_all(funs(mean), na.rm = TRUE)
sum1

sum2 <- gather(sum1, -cluster, key = variable, value = value)
sum2
sum_total <- ec1 %>% summarize_all(funs(mean))

sum_total <- gather(sum_total, key = variable, value = overall_mean)
sum2 <- left_join(sum2, sum_total, by = "variable")


sum2 <- sum2 %>% group_by(variable) %>% mutate(varmeans = mean(value))

sum2 <- sum2 %>% group_by(variable) %>% mutate(varmeans = mean(value))

```

The clustering above helps us understand which questions may have a better rating in relation to course instruction.  In this case, it would appear that the means of each cluster are not that dispered, meaning that no one question was that great of an indicator of course content (e.g., the instructor did comparatively well in instruction as it related to explanation of course content, assignments, and fairness).