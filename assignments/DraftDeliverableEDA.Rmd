---
title: "Initial Data Exploration"
author: "Patrick Voorhies & Nikki Tucker"
date: "November and December 2019"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message=FALSE)
```


```{r}
#Load Libraries
library(tidyverse)
library(knitr)
library(ggplot2)
library(tidyverse)
library(dplyr)


#Load Data
mydata = read.csv("survey_results_public.csv")

```


```{r}

summary(mydata)

```
## Graph the Categorical Variables

```{r}
#Work Location
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = WorkLoc))

#Work Remote
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = WorkRemote))

#Work Location
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = WorkLoc))

#Reasons why you might update your resume
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = ResumeUpdate))


#Has programming led to a better life?
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = BetterLife))

#Describe your employment status
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = Employment))

#Describe your career satisfaction
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = CareerSat))

#Describe your job seeking status
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = JobSeek))

#Describe your job satisfaction
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = JobSat))

#Describe your manager's competency
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = MgrIdiot))

#Do you believe you need to be a manager to make more money?
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = MgrMoney))

#Do you want to become a manager?
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = MgrWant))

#Describe your tenure in your current role.
ggplot(data = mydata) +
  geom_bar(mapping = aes(x = LastHireDate))

```

#Continuous Variables

```{r}
#Compensation Total in USD

ggplot(mydata, aes(x = ConvertedComp)) +
        geom_histogram(binwidth = 20000)

#Hours worked per week with mean

ggplot(mydata, aes(x = WorkWeekHrs)) +
        geom_histogram(binwidth = 1, breaks = seq(0, 100, 20), limits = c(-5, 100),expand = c(0, 0)) + geom_vline(aes(xintercept=mean(WorkWeekHrs, na.rm=T)),   # Ignore NA values for mean
               color="red", linetype="dashed", size=1) 


```

#Examination of Hypothesis

```{r fig.width=10,fig.height=11}
#H1: The more competent a manager is perceived by the developer, the less likely they are to report that they are seeking other employment.


ggplot(data = mydata) +
  geom_count(mapping = aes(x = JobSeek, y = MgrIdiot)) +
  theme(axis.text.x = element_text(angle = 90, hjust=1))

#H2: Longer tenured developers will be less likely to report that they are seeking other employment.

mydata %>% 
  count(LastHireDate, JobSeek) %>%  
  ggplot(mapping = aes(x = JobSeek, y = LastHireDate)) +
    geom_tile(mapping = aes(fill = n)) +
  theme(axis.text.x = element_text(angle = 90, hjust=1))
  

#H3: Developers who are underpaid will be more likely to intend to seek other employment.

ggplot(data = mydata, mapping = aes(x = JobSeek, y = ConvertedComp)) + 
  ylim(0, 250000) +
  geom_boxplot() + 
  coord_flip()

#H4:  Developers who do not work in their preferred work location are more likely to report that they are seeking other employment



ggplot(data = mydata) +
  geom_count(mapping = aes(x = WorkLoc, y = JobSat)) +
  theme(axis.text.x = element_text(angle = 90, hjust=1))



#H5: Developers who report that they work more than 40 weeks on average are more likely to report that they are seeking other employment.

ggplot(data = mydata, mapping = aes(x = JobSeek, y = WorkWeekHrs)) + 
  ylim(20, 60) +
  geom_boxplot() + 
  coord_flip()

```

# BONUS: Is pay related to Job Seeking Status?
Developers who are paid well above the mean report that they are less likely to be seeking other employment.  

```{r fig.width=10,fig.height=11}
#Check Factor Status of Job Seek variable
mydata$JobSeek.f <- factor(mydata$JobSeek)
is.factor(mydata$JobSeek.f)

#Convert Categorical Text to Factors 
res <- model.matrix(~JobSeek, data = mydata)
head(res[, ])

model2 <- lm(ConvertedComp ~ JobSeek,
             data = mydata)
summary(model2)

#The factors have been coded in this manner
#0= I am actively looking for a job
#1= I am not interested in new job opportunities
#2= I'm not actively looking, but I am open to new opportunities

#Plotting regression
mod1<-lm(ConvertedComp~JobSeek,data=mydata) #outcome on left (Converted Comp), predictor on right (Job Seeking Status)
summary(mod1)
confint(mod1)

g1<-ggplot(mydata, aes(x=JobSeek,y=ConvertedComp))+ 
  geom_bar(stat="identity")+ #specify data and x and y
           geom_point(shape=1)+ #specify points
           geom_smooth(method=lm)+  #ask for lm line
  theme(axis.text.x = element_text(angle = 90, hjust=1)) +
    scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
   scale_y_continuous(labels = scales::comma) +
  ylim(10000, 200000)

g1

```


# Algorithm 1:  Regression Prediction

```{r}

#Plotting a simple bivariate regression
mod1<-lm(WorkWeekHrs~WorkWeekHrs,data=mydata) #outcome on left (ConvertedComp), predictor on right (WorkWeekHrs)
summary(mod1)
confint(mod1)

g1<-ggplot(mydata, aes(x=WorkWeekHrs,y=ConvertedComp))+ #specify data and x and y
           geom_point(shape=1)+ #specify points
           geom_smooth(method=lm)+ #ask for lm line
           ylim(0, 120000) +
            xlim(0, 50)

g1


#Predictions

fortyhrprediction<- 122663.86 + (40 * 112.26)
fortyhrprediction 

thirtyhourprediction<- 122663.86 + (30 * 112.26)
thirtyhourprediction

fiftyfivehourprediction<- 122663.86 + (55 * 112.26)
fiftyfivehourprediction

twentyhourprediction<- 122663.86 + (20 * 112.26)
twentyhourprediction
```

Our Regression Predictions:
[40 hour work week] 127154.3
[30 hour work week] 126031.7
[55 hour work week] 128838.2
[20 hour work week] 124909.1

# GOD HELP ME ON THE FOLLOWING:

# Algorithm 2: Conditional Means

```{r fig.width=10,fig.height=11}



```


# Cross-Validation (LN / Ch 10 (11)(Week 11))

